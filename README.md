# BTS1_HW
 
Exploratory tour (CRUD + Write-off)
Цель: проверить все основные методы API (CRUD + списание времени), првоерить риски валидации, пагинации и согласованности данных/логов.
Ожидаемые проблемы:
дубликаты и перезапись при повторном POST с тем же id;
неверные коды (напр., 416 вместо 404), "сырой текст" вместо JSON;
некорректная валидация time (отрицательные/float/строки/overspend);
несоответствие id в path/body, опции пагинации start/end (off-by-one, end);
слабая наблюдаемость: дублирующиеся/шумные логи, отсутствие ключевых полей в логах.
Чек-лист туров:
CRUD tour (создать/посмотреть/обновить/удалить)
Zero–One–Many: time в {0,1,максимум,больше максимума}; пустые/длинные строки
Boundary: {-1,0,1, max-1, max, max+1}
Garbage: неверные типы (string/float/null), пустое тело, text вместо JSON
Pagination: start<0, end, большие окна, 1 запись
Error Guessing: несоответствие id в path/body, удалённые/несуществующие сущности
Observability: полезность логов (уровень, отсутствие полей)
Наборы тестовых данных:
id: новый; существующий; удалённый; большое значение (9990999)
time : [-1, 0, 1, 59, 60, 61, 999999] title/content: "", " ", ASCII(1), ASCII(255/256/2048), Unicode, пробелы/табы/nb-space
Пагинация: (start,end) > (0,1), (-1,1), (5,1), (0,1000)
HW 1 Exploratory testing (отчёт)
Время: 2025-08-20, 14:00–15:00
Среда: Docker (image upbeat_ellis), http://localhost:8080



Краткое описание
Пройдены базовые позитивные кейсы, границы time (0/1/60/61), текстовые поля (пусто/256/Unicode), пагинация
Найдены критичные проблемы стабильности: 500 + panic на GET /activities при неверных параметрах; некорректная обработка ошибок пагинации.
Валидация типов реализована только частично (float в time даёт 400), поведение по границам/кодам не согласовано с ожиданиями.
Логи информативны, но есть мешающие записи (405 MethodNotAllowed перед успешными 200) и мешанина в уровнях.
Покрытие
Boundaries: POST /activities с time {0,1,60,61} — все вернули 200
Найденные проблемы (по приоритетам)
GET /activities приводит к 500 при неверных параметрах.
В логах: unable to process request (internal error) status=500 ... ParseError(ParseIntError { kind: InvalidDigit }), затем panic в src/routes/activities.rs:20:27 (slice index starts at 5 but ends at 1).
Похоже, некорректная работа с пагинацией (парсинг без проверок) приводит к аварийному завершению
start<0 возвращает 416 Range Not Satisfiable вместо ожидаемых 400/422 или нормализации.
Границы time фактически не ограничены: time=0 и даже time=-1 проходят под 200.
Нестабильные/смешанные ошибки на POST /activities в логах: подряд идут 405 MethodNotAllowed, 404 NotFound, затем 200.
Шумные логи: множественные processing request/finished processing и MethodNotAllowed на один фактический вызов создают спам на INFO/WARN. Сложно выявить причину проблемы.
Разный формат ошибок: в логах детальный warp-стек с внутренними типами (Rejection(...), BodyDeserializeError …), но судя по всему, приходит просто код без JSON-тела.
Подробности по ключевым кейсам
Boundaries (time)
POST_time_0/1/60/61 — все 200. Если 0 и > 60 не должны приниматься, нужны правила валидации и корректные коды (422 Unprocessable Entity лучше, если тело запроса синтаксически верное).
Пагинация
GET … start=0&end=1 — ОК (200, массив ≤1). GET … start=-1&end=1 — 416, что является ошибкой диапазона для Range заголовков, а не для query параметров. ОР - 400 (некорректный ввод)
Типы
Float в time → 400 (из логов invalid type: floating point 5.5)
Предложения по улучшению
Защита от 500
 Перед парсингом start/end проверять, что это целые неотрицательные числа; для end < start — возвращать 400/422
 Любые операции со слайсами — только после проверок на границы
Единая валидация и коды
 Определить и задокументировать допустимый диапазон time
 Для невалидных JSON/типов — 400 + JSON-ошибка.
Унификация поведения пагинации
 Приведём start<0 к 0 или возвращаем 400/422?
 Строгое правило для endДобавить в логи ключевые поля (start, end, фактическая длина выборки).
Логи
 Понизить количество записей processing или сгруппировать их.
 405 от промежуточных фильтров — не логировать как WARN или лучше их скрыть
 Для ERROR/WARN добавлять краткую часть входных данных

Хотелось бы единый JSON-формат для ошибок


